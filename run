#!/bin/sh

. /etc/sin/lib
if [ -n "$2" ]; then 
    . "/etc/sin/sv/$2" || die "$0: unknown service '$1'"
fi

usage() {
    cat << .
Usage: $0 [OPTIONS] SERVICE

Options:
    --start         | -s    Start a service
    --kill | --stop | -k    Stop a service
    --restart       | -r    Restart a service
    --version       | -V    Display sin's version
    --help          | -h    Show this help message and exit
.
}

case $1 in
    --start|-s)
        start || die "$0: failed to start '$2'"
        ;;
    --kill|--stop|-k)
        stop || die "$0: failed to stop '$2'"
        ;;
    --restart|-r)
        if ! type restart >/dev/null 2>&1 | grep -q function; then
            ( stop && start ) || die "$0: failed to restart '$2'"
        else
            restart || die "$0: failed to restart '$2'"
        fi
        ;;
    --version|-V)
        echo "0.0.0"
        ;;
    --help|-h)
        usage
        ;;
esac
